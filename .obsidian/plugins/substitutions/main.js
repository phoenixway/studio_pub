/* THIS IS A GENERATED/BUNDLED FILE BY ESBUILD see https://github.com/BambusControl/obsidian-substitutions for the source */
"use strict";var D=Object.defineProperty,ft=Object.defineProperties,pt=Object.getOwnPropertyDescriptor,bt=Object.getOwnPropertyDescriptors,St=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable;var L=(e,t,i)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,u=(e,t)=>{for(var i in t||(t={}))U.call(t,i)&&L(e,i,t[i]);if(H)for(var i of H(t))gt.call(t,i)&&L(e,i,t[i]);return e},m=(e,t)=>ft(e,bt(t));var ht=(e,t)=>{for(var i in t)D(e,i,{get:t[i],enumerable:!0})},vt=(e,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of St(t))!U.call(e,r)&&r!==i&&D(e,r,{get:()=>t[r],enumerable:!(o=pt(t,r))||o.enumerable});return e};var Rt=e=>vt(D({},"__esModule",{value:!0}),e);var n=(e,t,i)=>new Promise((o,r)=>{var s=a=>{try{l(i.next(a))}catch(f){r(f)}},d=a=>{try{l(i.throw(a))}catch(f){r(f)}},l=a=>a.done?o(a.value):Promise.resolve(a.value).then(s,d);l((i=i.apply(e,t)).next())});var Dt={};ht(Dt,{default:()=>V});module.exports=Rt(Dt);var dt=require("obsidian");var E=require("obsidian");var G=require("obsidian");function p(e){return e.from!=""&&e.to!=""}function N(e){return(e?"Disable":"Enable")+" substitution"}function W(e){return t=>t.setTooltip(N(t.getValue())).setValue(e.enabled).onChange(i=>{e.enabled=i,t.setTooltip(N(i))})}function y(e,t,i){return n(this,null,function*(){let o=!e.settingEl.hasClass("filled-substitution"),r=p(t);o&&r&&(e.setClass("filled-substitution"),yield i())})}function O(e,t,i){return o=>o.setPlaceholder("Replace").onChange(r=>n(this,null,function*(){e.from=r,yield y(t,e,i)})).setValue(e.from)}function $(e,t,i){return o=>o.setPlaceholder("With").onChange(r=>n(this,null,function*(){e.to=r,yield y(t,e,i)})).setValue(e.to)}function q(e,t){return i=>i.setIcon("x").setTooltip("Remove substitution").onClick(()=>{e.action=2,t.settingEl.hide()})}function J(e,t,i){let o=new G.Setting(e).setClass("substitution-record");return p(t)&&o.setClass("filled-substitution"),o.addToggle(W(t)).addText(O(t,o,i)).addText($(t,o,i)).addExtraButton(q(t,o))}var v=class{constructor(t,i,o=()=>{}){this._record=t;this._container=i;this._onFill=o;this._setting=null}get record(){return this._record}display(){return this._setting!=null?this._setting:(this._setting=J(this._container,this.record,this._onFill),this._setting)}};function K(){return{from:"",to:"",enabled:!0,id:-1,action:1}}var w=class e extends E.PluginSettingTab{constructor(i,o,r){super(i,o);this.dataStore=r;this.rendered=!1;this.storedRecords=[];this.newRecords=[];this.containerEl.addClass("plugin","substitutions","setting-tab")}display(){return n(this,null,function*(){if(this.rendered)return;let i=this.containerEl.createDiv({cls:"heading"});new E.Setting(i).setHeading().setName("Substitutions").setDesc("Here you can set and enable automatic text substitutions. Auto paired characters, like brackets, currently do not work.");let o=this.containerEl.createDiv({cls:["substitutions","new"]}),r=this.containerEl.createDiv({cls:"substitutions"});this.storedRecords=(yield this.dataStore.getModifiableSubstitutionRecords()).map(s=>new v(s,r)),e.registerNewSubstitutionRecordSetting(o,this.newRecords);for(let s of this.records)s.display();this.rendered=!0})}hide(){return n(this,null,function*(){yield this.dataStore.overwriteSubstitutionRecords(this.records.map(i=>i.record))})}get records(){return[...this.newRecords,...this.storedRecords]}static registerNewSubstitutionRecordSetting(i,o){let r=new v(K(),i,()=>{e.registerNewSubstitutionRecordSetting(i,o).display()});return o.unshift(r),r}};var P=class extends Error{};var M=class{constructor(t,i,o){this.getCallback=t;this.persistCallback=i;this.value=o}get(){return n(this,null,function*(){return this.value==null&&(this.value=yield this.getCallback()),this.value})}set(t){this.value=t}persist(){return n(this,null,function*(){if(this.value==null)throw new P("Refuse to persist a null value");return yield this.persistCallback(this.value),this.value})}};var b="0.1.0";function T(){return{initialized:!1,version:b,substitutions:{initialized:!1,records:[{from:"...",to:"\u2026",enabled:!0},{from:"1/2",to:"\xBD",enabled:!0},{from:"1/3",to:"\u2153",enabled:!0},{from:"1/4",to:"\xBC",enabled:!0},{from:"1/5",to:"\u2155",enabled:!0},{from:"1/6",to:"\u2159",enabled:!0},{from:"1/7",to:"\u2150",enabled:!0},{from:"1/9",to:"\u2151",enabled:!0},{from:"1/10",to:"\u2152",enabled:!0},{from:"1/8",to:"\u215B",enabled:!0},{from:"2/3",to:"\u2154",enabled:!0},{from:"2/5",to:"\u2156",enabled:!0},{from:"3/4",to:"\xBE",enabled:!0},{from:"3/5",to:"\u2157",enabled:!0},{from:"4/5",to:"\u2158",enabled:!0},{from:"5/6",to:"\u215A",enabled:!0},{from:"3/8",to:"\u215C",enabled:!0},{from:"5/8",to:"\u215D",enabled:!0},{from:"7/8",to:"\u215E",enabled:!0},{from:"<--",to:"\u2190",enabled:!0},{from:"-->",to:"\u2192",enabled:!0},{from:"<->",to:"\u2194",enabled:!0},{from:"<==",to:"\u21D0",enabled:!0},{from:"==>",to:"\u21D2",enabled:!0},{from:"<=>",to:"\u21D4",enabled:!0},{from:"--",to:"\u2013",enabled:!1},{from:"---",to:"\u2014",enabled:!1},{from:"!=",to:"\u2260",enabled:!0},{from:"<=",to:"\u2264",enabled:!0},{from:">=",to:"\u2265",enabled:!0},{from:"~=",to:"\u2245",enabled:!0},{from:"+-",to:"\xB1",enabled:!0},{from:"-+",to:"\u2213",enabled:!0},{from:"<<",to:"\u226A",enabled:!0},{from:">>",to:"\u226B",enabled:!0}]}}}function Q(e){return e!=null&&"initialized"in e&&"version"in e}function X(e){return n(this,null,function*(){let t=yield e.loadData();return Q(t)?t:u({},T())})}var C=class{constructor(t){this.dataLoader=t;this.storedData=new M(()=>X(t),i=>t.saveData(i))}isInitialized(){return n(this,null,function*(){let t=yield this.storedData.get();return t.initialized&&t.version===b})}setInitialized(t){return n(this,null,function*(){yield this.mergeData({initialized:t})})}isCurrentVersion(){return n(this,null,function*(){return(yield this.storedData.get()).version===b})}getSubstitutions(){return n(this,null,function*(){return(yield this.storedData.get()).substitutions})}overwriteSubstitutions(t){return n(this,null,function*(){return(yield this.mergeData({substitutions:t})).substitutions})}setInitializedSubstitutions(t){return n(this,null,function*(){let i=yield this.getSubstitutions(),o=m(u({},i),{initialized:t});yield this.overwriteSubstitutions(o)})}mergeData(t){return n(this,null,function*(){let i=yield this.storedData.get(),o=m(u(u({},i),t),{version:t.initialized?b:i.version});return this.storedData.set(o),yield this.storedData.persist()})}};var z=class{constructor(t){this.dataStore=t}initializeData(){return n(this,null,function*(){yield this.initializeAll()})}initializeAll(){return n(this,null,function*(){(yield this.dataStore.isInitialized())||((yield this.dataStore.isCurrentVersion())||(yield this.dataStore.setInitialized(!1),yield this.dataStore.setInitializedSubstitutions(!1)),yield this.initializeSubstitutions(),yield this.dataStore.setInitialized(!0))})}initializeSubstitutions(){return n(this,null,function*(){(yield this.dataStore.getSubstitutions()).initialized||(yield this.dataStore.overwriteSubstitutions(m(u({},T().substitutions),{initialized:!0})))})}};function Y(e,t){return m(u({},e),{id:t,action:0})}function Z(e){return{from:e.from,to:e.to,enabled:e.enabled}}function j(e){return e.action!=2}var I=class{constructor(t,i){this.store=t;this.substitutionsModifiedCallback=i}getSubstitutionRecords(){return n(this,null,function*(){return(yield this.store.getSubstitutions()).records})}getModifiableSubstitutionRecords(){return n(this,null,function*(){return(yield this.getSubstitutionRecords()).map(Y)})}overwriteSubstitutionRecords(t){return n(this,null,function*(){let i=yield this.store.getSubstitutions(),r=new Array(...t.values()).filter(p).filter(j).map(Z),s=yield this.store.overwriteSubstitutions(m(u({},i),{records:r}));this.substitutionsModifiedCallback(s.records)})}};var it=require("@codemirror/view");function S(e){return u(u({},xt),e)}var xt={cache:"",length:0,matches:[],substitution:null};function tt(e,t){return(e.cache+t).slice(-e.length)}var F=require("@codemirror/state"),c={update:F.StateEffect.define(),substitute:F.StateEffect.define(),revert:F.StateEffect.define()};function et(e,t){return e.update({effects:[c.update.of(t)]})}var B=require("@codemirror/state");function k(e,t,i){let o=e.changeByRange(r=>{let s=B.EditorSelection.range(r.anchor-(t.length-1),r.head),d=B.EditorSelection.cursor(s.anchor+i.length);return{range:d,changes:[{insert:i,from:s.from,to:s.to}],effects:[c.substitute.of({from:t,to:i,endPosition:d.to-1})]}});return e.update(o,{scrollIntoView:!0})}function ot(e){return it.EditorView.inputHandler.of((t,i,o,r,s)=>{var _;if(!!(t.compositionStarted||t.state.readOnly))return!1;let l=t.state.selection.main,a=r.length!==1,f=i===l.from&&o===l.to;if(a||!f)return!1;let g=(_=t.state.field(e,!1))!=null?_:S(),x=tt(g,r),h=g.matches.find(ct=>x.endsWith(ct.from)),mt=h==null?[s(),et(t.state,r)]:[k(t.state,h.from,h.to)];return t.dispatch(...mt),!0})}var rt=require("@codemirror/view");function nt(e){return rt.EditorView.updateListener.of(t=>{var g,x;if(!t.transactions.some(h=>h.isUserEvent("delete.backward")))return;let o=t.state,r=o.selection.main;if(r.from!==r.to)return;let s=r.to,d=(g=o.field(e,!1))!=null?g:S(),l=(x=d.substitution)==null?void 0:x.endPosition;if(d.substitution==null||s!==l)return;let a=k(o,d.substitution.to,d.substitution.from),f=o.update({effects:[c.revert.of(null)]});t.view.dispatch(a,f)})}var at=require("@codemirror/state");function st(e,t){let i=e.selection.asSingle().main.head,o=Math.max(0,i-t);return e.sliceDoc(o,i)}function ut(e){let t=e.filter(s=>s.enabled),i=t.map(s=>s.from.length),o=Math.max(...i),r=s=>S(u({length:o,matches:t},s));return at.StateField.define({create(){return r()},update(s,d){let l=s;for(let a of d.effects)a.is(c.update)?l=m(u({},l),{cache:st(d.state,l.length)}):a.is(c.substitute)?l=r({substitution:{from:a.value.from,to:a.value.to,endPosition:a.value.endPosition}}):a.is(c.revert)&&(l=r());return l}})}function lt(e){let t=ut(e);return[t,ot(t),nt(t)]}var R=class e{static replaceAndUpdate(t,i,o){e.replaceExtensions(t,i),o.updateOptions()}static replaceAndRegister(t,i,o){e.replaceExtensions(t,i),o.registerEditorExtension(t)}static replaceExtensions(t,i){for(;t.length>0;)t.pop();t.push(lt(i))}};var V=class extends dt.Plugin{constructor(t,i){super(t,i),this.extensions=[]}onload(){return n(this,null,function*(){let t=new C(this),i=new z(t),o=new I(t,s=>R.replaceAndUpdate(this.extensions,s,this.app.workspace));yield i.initializeData();let r=yield o.getSubstitutionRecords();R.replaceAndRegister(this.extensions,r,this),this.addSettingTab(new w(this.app,this,o))})}};
